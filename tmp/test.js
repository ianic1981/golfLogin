"use strict";
const Nightmare = require("nightmare");
const moment = require("moment");
const nightmare = new Nightmare({ show: false });
var argv = require('minimist')(process.argv.slice(2));
console.log(argv);
var user = argv.user;
var pwd = process.env.pwd || argv.pwd;
console.log(pwd);
let myMoment = moment();
myMoment.add(21, 'days');
console.log(myMoment.date());
console.log(myMoment.month());
const dayOption = myMoment.date();
const monthOption = myMoment.month();
nightmare
    .goto('https://www.brsgolf.com/wychwoodpark/member/login')
    .type('[name="_username"]', user)
    .type('[name="_password"]', pwd)
    .click('input[name="SUBMIT"]')
    .wait('.book_a_tee_time_button')
    .click('.book_a_tee_time_button')
    .evaluate(selectMonth, monthOption)
    .evaluate(selectDay, dayOption)
    .wait(".table_white_text")
    .evaluate(() => {
    let inputs = document.querySelector(".table_white_text tbody").querySelectorAll("tr");
    for (var i = 0, length = inputs.length; i < length; i++) {
        var data = inputs[i].innerText.trim();
        if (data.indexOf('08:') >= 0 && data.length == 5) {
            var val = inputs[i].querySelectorAll("input[name=\"SubmitButton\"]");
            val[0].click();
            return data;
        }
    }
    return "no time";
}).then(console.log)
    .then(() => {
    return nightmare
        .wait('.back_button_cell a')
        .wait(1000)
        .select("[name='Player1_uid']", "448")
        .select("[name='Player2_uid']", "449")
        .select("[name='Player3_uid']", "Member")
        .select("[name='Player4_uid']", "Member")
        .wait(3000)
        .click('[name=\'SubmitButton\']')
        .wait(1000)
        .end(() => "finished");
})
    .then(console.log)
    .catch((error) => {
    console.error('Search failed:', error);
});
console.log("start");
function selectMonth(month) {
    console.log(month);
    var test = document.querySelector(".month_navigation .t_b");
    var test2 = test.getElementsByTagName("a");
    test2.item(month).click();
}
function selectDay(dayOption) {
    console.log(dayOption);
    let day = document.querySelector(".tableList tbody").getElementsByTagName("tr")[dayOption];
    day.getElementsByClassName("day_num").item(0).getElementsByTagName("a").item(0).click();
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGVzdC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uL3Rlc3QudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLHVDQUF1QztBQUN2QyxpQ0FBaUM7QUFFakMsTUFBTSxTQUFTLEdBQUcsSUFBSSxTQUFTLENBQUMsRUFBQyxJQUFJLEVBQUUsS0FBSyxFQUFDLENBQUMsQ0FBQztBQUUvQyxJQUFJLElBQUksR0FBRyxPQUFPLENBQUMsVUFBVSxDQUFDLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUN0RCxPQUFPLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxDQUFBO0FBR2pCLElBQUksSUFBSSxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUM7QUFDckIsSUFBSSxHQUFHLEdBQUcsT0FBTyxDQUFDLEdBQUcsQ0FBQyxHQUFHLElBQUksSUFBSSxDQUFDLEdBQUcsQ0FBQztBQUV0QyxPQUFPLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFBO0FBRWhCLElBQUksUUFBUSxHQUFrQixNQUFNLEVBQUUsQ0FBQztBQUd2QyxRQUFRLENBQUMsR0FBRyxDQUFDLEVBQUUsRUFBRSxNQUFNLENBQUMsQ0FBQTtBQUV4QixPQUFPLENBQUMsR0FBRyxDQUFDLFFBQVEsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFBO0FBQzVCLE9BQU8sQ0FBQyxHQUFHLENBQUMsUUFBUSxDQUFDLEtBQUssRUFBRSxDQUFDLENBQUE7QUFFN0IsTUFBTSxTQUFTLEdBQUcsUUFBUSxDQUFDLElBQUksRUFBRSxDQUFDO0FBQ2xDLE1BQU0sV0FBVyxHQUFHLFFBQVEsQ0FBQyxLQUFLLEVBQUUsQ0FBQztBQUVyQyxTQUFTO0tBQ0osSUFBSSxDQUFDLG1EQUFtRCxDQUFDO0tBQ3pELElBQUksQ0FBQyxvQkFBb0IsRUFBRSxJQUFJLENBQUM7S0FDaEMsSUFBSSxDQUFDLG9CQUFvQixFQUFFLEdBQUcsQ0FBQztLQUMvQixLQUFLLENBQUMsc0JBQXNCLENBQUM7S0FDN0IsSUFBSSxDQUFDLHlCQUF5QixDQUFDO0tBQy9CLEtBQUssQ0FBQyx5QkFBeUIsQ0FBQztLQUNoQyxRQUFRLENBQUMsV0FBVyxFQUFFLFdBQVcsQ0FBQztLQUNsQyxRQUFRLENBQUMsU0FBUyxFQUFFLFNBQVMsQ0FBQztLQUM5QixJQUFJLENBQUMsbUJBQW1CLENBQUM7S0FDekIsUUFBUSxDQUFDO0lBRU4sSUFBSSxNQUFNLEdBQUcsUUFBUSxDQUFDLGFBQWEsQ0FBQyx5QkFBeUIsQ0FBQyxDQUFDLGdCQUFnQixDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ3RGLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxNQUFNLEdBQUcsTUFBTSxDQUFDLE1BQU0sRUFBRSxDQUFDLEdBQUcsTUFBTSxFQUFFLENBQUMsRUFBRSxFQUFFLENBQUM7UUFFdEQsSUFBSSxJQUFJLEdBQUcsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxJQUFJLEVBQUUsQ0FBQztRQUN0QyxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsSUFBSSxJQUFJLENBQUMsTUFBTSxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDL0MsSUFBSSxHQUFHLEdBQUcsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLGdCQUFnQixDQUFDLDhCQUE4QixDQUFDLENBQUM7WUFFckUsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssRUFBRSxDQUFDO1lBQ2YsTUFBTSxDQUFDLElBQUksQ0FBQztRQUNoQixDQUFDO0lBQ0wsQ0FBQztJQUNELE1BQU0sQ0FBQyxTQUFTLENBQUM7QUFDckIsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUM7S0FDbkIsSUFBSSxDQUFDO0lBRUYsTUFBTSxDQUFDLFNBQVM7U0FDWCxJQUFJLENBQUMscUJBQXFCLENBQUM7U0FDM0IsSUFBSSxDQUFDLElBQUksQ0FBQztTQUNWLE1BQU0sQ0FBQyxzQkFBc0IsRUFBRSxLQUFLLENBQUM7U0FDckMsTUFBTSxDQUFDLHNCQUFzQixFQUFFLEtBQUssQ0FBQztTQUNyQyxNQUFNLENBQUMsc0JBQXNCLEVBQUUsUUFBUSxDQUFDO1NBQ3hDLE1BQU0sQ0FBQyxzQkFBc0IsRUFBRSxRQUFRLENBQUM7U0FDeEMsSUFBSSxDQUFDLElBQUksQ0FBQztTQUNWLEtBQUssQ0FBQyx5QkFBeUIsQ0FBQztTQUNoQyxJQUFJLENBQUMsSUFBSSxDQUFDO1NBRVYsR0FBRyxDQUFDLE1BQU0sVUFBVSxDQUFDLENBQUE7QUFHOUIsQ0FBQyxBQUg2QixDQUc3QjtLQUNBLElBQUksQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDO0tBQ2pCLEtBQUssQ0FBQyxDQUFDLEtBQUs7SUFDVCxPQUFPLENBQUMsS0FBSyxDQUFDLGdCQUFnQixFQUFFLEtBQUssQ0FBQyxDQUFDO0FBQzNDLENBQUMsQ0FBQyxDQUFDO0FBRVAsT0FBTyxDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsQ0FBQztBQUVyQixxQkFBcUIsS0FBSztJQUV0QixPQUFPLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQ25CLElBQUksSUFBSSxHQUFHLFFBQVEsQ0FBQyxhQUFhLENBQUMsd0JBQXdCLENBQUMsQ0FBQztJQUM1RCxJQUFJLEtBQUssR0FBRyxJQUFJLENBQUMsb0JBQW9CLENBQUMsR0FBRyxDQUFDLENBQUM7SUFDM0MsS0FBSyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxLQUFLLEVBQUUsQ0FBQTtBQUM3QixDQUFDO0FBRUQsbUJBQW1CLFNBQVM7SUFFeEIsT0FBTyxDQUFDLEdBQUcsQ0FBQyxTQUFTLENBQUMsQ0FBQztJQUN2QixJQUFJLEdBQUcsR0FBRyxRQUFRLENBQUMsYUFBYSxDQUFDLGtCQUFrQixDQUFDLENBQUMsb0JBQW9CLENBQUMsSUFBSSxDQUFDLENBQUMsU0FBUyxDQUFDLENBQUM7SUFDM0YsR0FBRyxDQUFDLHNCQUFzQixDQUFDLFNBQVMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxFQUFFLENBQUM7QUFDNUYsQ0FBQyJ9